var counter = !1, newSessionAgent = !1, newSessionMsg = !1, newSessionMinimize = !1, newSessionStartOver = !1, newSessionChatTranscript = !1, newSessionClose = !1, newSessionsocketConnected = !1, chatdetails = ""; function getCookie(e) { let t = {}; return document.cookie.split(";").forEach(function (e) { var o = e.split("=")[0], n = e.split("=")[1]; t[o.trim()] = n }), t[e] } var socketConnected = "", isChatOpen = "", isChatAgentConnected = "", chatId = "", engagementId = "", chatEngineType = "", clickedStartOver = !1, isChatActive = "", chatEntry = "", omnitureCookieNames = ["__csomni", "__ceidomni", "__cacomni", "__cminomni", "__cromni", "__ctromni", "__cepomni"]; function EchatPayloadCall(e, t) { setTimeout(function () { 1 === $("#eChat_LM_GA").length && !1 === counter && ("function" == typeof s_oTrackPage && s_oTrackPage({ s_oLSTB: "Chat~" + e + "~" + chatButtonType + "~" + t + "~eChat_LM_GA~R", s_oAPT: "965-0-0" }), counter = !0) }, 5e3) } setInterval(function () { null != getCookie("__cwss") && null != getCookie("__cwss") && "" != getCookie("__cwss") && (socketConnected = getCookie("__cwss")), null != getCookie("__cwof") && null != getCookie("__cwof") && "" != getCookie("__cwof") && (isChatOpen = getCookie("__cwof")), isChatAgentConnected = getCookie("__caf"), engagementId = null != getCookie("__cpseid") && null != getCookie("__cpseid") && "" != getCookie("__cpseid") ? getCookie("__cpseid") : "NA", chatId = null != getCookie("__csid") && null != getCookie("__csid") && "" != getCookie("__csid") ? getCookie("__csid") : "NA", null != getCookie("__cepomni") && "" != getCookie("__cepomni") && (chatEntry = getCookie("__cepomni")) }, 2e3); var entryPointID = ""; function getChatButtonType(e) { switch (e) { case "eChat_LM_ContactUs": case "eChat_LM_Escalations": return "F"; case "eChat_LM_GA": default: return "G" } } function getPosition(e) { switch (e) { case "eChat_LM_ContactUs": return "BR"; case "eChat_LM_Escalations": return "T1"; case "eChat_LM_GA": default: return "BR" } } var position = "", chatButtonType = ""; function NewSessionPayloadCall(e, t, o) { position = getPosition(entryPointID = null != chatEntry ? chatEntry : "eChat_LM_GA"), chatButtonType = getChatButtonType(entryPointID); var n = { attributes: !0, childList: !0, characterData: !0 }; const i = new MutationObserver(function (o) { for (var n = o.length, s = o[n - 1], c = 0; c < s.addedNodes.length; c++)if (!s.addedNodes[c].contains(document.querySelector("#agentTypingDots"))) { var _ = getCookie("__ceidomni"); newSessionAgent = "966-0-0" == _, engagementId = null != getCookie("__cpseid") && null != getCookie("__cpseid") && "" != getCookie("__cpseid") ? getCookie("__cpseid") : "NA", chatId = null != getCookie("__csid") && null != getCookie("__csid") && null != getCookie("__csid") ? getCookie("__csid") : "NA", newSessionAgent || "true" !== getCookie("__caf") || (setCookie("__ceidomni", "966-0-0"), s_oTrackPage({ s_oChat: chatId + "~" + engagementId + "~" + e + "~" + chatButtonType + "~" + position + "~Agent~" + entryPointID + "~" + t + "~NA~CA", s_oAPT: "966-0-0", s_oAJC: !0 }), newSessionAgent = !0, i.disconnect()) } }); $(document).ready(function () { $(document).on("click", ".echat-send-button", function () { var o = getCookie("__csomni"); newSessionMsg = "967-0-0" == o, chatId = null != getCookie("__csid") && null != getCookie("__csid") && "" != getCookie("__csid") ? getCookie("__csid") : "NA", newSessionMsg || (setCookie("__csomni", "967-0-0"), s_oTrackPage({ s_oChat: chatId + "~" + engagementId + "~" + e + "~" + chatButtonType + "~" + position + "~Bot~" + entryPointID + "~" + t + "~NA~CS", s_oAPT: "967-0-0", s_oAJC: !0 }), newSessionMsg = !0) }), $(document).on("click", ".eChat-agent-text-button-small, .echat-blue-button-text, .eChat-secondaryCta", function () { var o = getCookie("__csomni"); newSessionMsg = "967-0-0" == o, chatId = null != getCookie("__csid") && null != getCookie("__csid") && "" != getCookie("__csid") ? getCookie("__csid") : "NA", newSessionMsg || (setCookie("__csomni", "967-0-0"), s_oTrackPage({ s_oChat: chatId + "~" + engagementId + "~" + e + "~" + chatButtonType + "~" + position + "~Bot~" + entryPointID + "~" + t + "~NA~CS", s_oAPT: "967-0-0", s_oAJC: !0 }), newSessionMsg = !0) }) }), $(document).on("click", "#closechatsession", function () { chatEngineType = "true" !== isChatAgentConnected && "True" !== isChatAgentConnected || null == isChatAgentConnected || null == isChatAgentConnected || "" == isChatAgentConnected ? "Bot" : "Agent", newSessionClose || (s_oTrackPage({ s_oChat: chatId + "~" + engagementId + "~" + e + "~" + chatButtonType + "~" + position + "~" + chatEngineType + "~" + entryPointID + "~" + t + "~user~CC", s_oAPT: "968-0-0", s_oAJC: !0 }), newSessionClose = !0, deleteCookies()) }), setInterval(function () { if ("true" !== getCookie("__caf") || newSessionAgent || (engagementId = null != getCookie("__cpseid") && null != getCookie("__cpseid") && "" != getCookie("__cpseid") ? getCookie("__cpseid") : "NA", $(document).on("click", ".echat-send-button", function () { var o = getCookie("__ceidomni"); newSessionAgent = "966-0-0" == o, chatId = null != getCookie("__csid") && null != getCookie("__csid") && "" != getCookie("__csid") ? getCookie("__csid") : "NA", newSessionAgent || "true" !== getCookie("__caf") || (setCookie("__ceidomni", "966-0-0"), s_oTrackPage({ s_oChat: chatId + "~" + engagementId + "~" + e + "~" + chatButtonType + "~" + position + "~Agent~" + entryPointID + "~" + t + "~NA~CA", s_oAPT: "966-0-0", s_oAJC: !0 }), newSessionAgent = !0) }), $(document).on("DOMSubtreeModified", "#messages", function () { var e = document.querySelector("#msgWindowHeight"); i.observe(e, n) })), "false" === socketConnected && "true" === isChatOpen) { var o = getCookie("__cacomni"); newSessionsocketConnected = "968-0-0" == o, chatId = null != getCookie("__csid") && null != getCookie("__csid") && "" != getCookie("__csid") ? getCookie("__csid") : "NA", null != getCookie("__cwf") && null != getCookie("__cwf") && "" != getCookie("__cwf") && (isChatActive = getCookie("__cwf")), chatEngineType = "true" !== isChatAgentConnected && "True" !== isChatAgentConnected || null == isChatAgentConnected || null == isChatAgentConnected || "" == isChatAgentConnected ? "Bot" : "Agent", newSessionsocketConnected || "true" != isChatActive || (setCookie("__cacomni", "968-0-0"), s_oTrackPage({ s_oChat: chatId + "~" + engagementId + "~" + e + "~" + chatButtonType + "~" + position + "~" + chatEngineType + "~" + entryPointID + "~" + t + "~Auto~CC", s_oAPT: "968-0-0", s_oAJC: !0 }), newSessionsocketConnected = !0) } }, 2e3), $(document).on("click", "#minimizeChatWindow", function () { var o = getCookie("__cminomni"); newSessionMinimize = "969-0-0" == o, chatId = null != getCookie("__csid") && null != getCookie("__csid") && "" != getCookie("__csid") ? getCookie("__csid") : "NA", chatEngineType = "true" !== isChatAgentConnected && "True" !== isChatAgentConnected || null == isChatAgentConnected || null == isChatAgentConnected || "" == isChatAgentConnected ? "Bot" : "Agent", newSessionMinimize || (setCookie("__cminomni", "969-0-0"), s_oTrackPage({ s_oChat: chatId + "~" + engagementId + "~" + e + "~" + chatButtonType + "~" + position + "~" + chatEngineType + "~" + entryPointID + "~" + t + "~NA~CM", s_oAPT: "969-0-0", s_oAJC: !0 }), newSessionMinimize = !0) }), $(document).on("click", "#minimizeChevronDown", function () { var o = getCookie("__cminomni"); newSessionMinimize = "969-0-0" == o, chatId = null != getCookie("__csid") && null != getCookie("__csid") && "" != getCookie("__csid") ? getCookie("__csid") : "NA", chatEngineType = "true" !== isChatAgentConnected && "True" !== isChatAgentConnected || null == isChatAgentConnected || null == isChatAgentConnected || "" == isChatAgentConnected ? "Bot" : "Agent", newSessionMinimize || (setCookie("__cminomni", "969-0-0"), s_oTrackPage({ s_oChat: chatId + "~" + engagementId + "~" + e + "~" + chatButtonType + "~" + position + "~" + chatEngineType + "~" + entryPointID + "~" + t + "~NA~CM", s_oAPT: "969-0-0", s_oAJC: !0 }), newSessionMinimize = !0) }), $(document).on("click", "#startOver", function () { clickedStartOver = !0 }), $(document).on("click", "#ButtonYes", function () { var o = getCookie("__cromni"); newSessionStartOver = "970-0-0" == o, chatId = null != getCookie("__csid") && null != getCookie("__csid") && "" != getCookie("__csid") ? getCookie("__csid") : "NA", !newSessionStartOver && clickedStartOver && (setCookie("__cromni", "970-0-0"), s_oTrackPage({ s_oChat: chatId + "~" + engagementId + "~" + e + "~" + chatButtonType + "~" + position + "~Bot~" + entryPointID + "~" + t + "~NA~CR", s_oAPT: "970-0-0", s_oAJC: !0 }), newSessionStartOver = !0, clickedStartOver = !1) }), $(document).on("click", "#ButtonNo", function () { chatId = null != getCookie("__csid") && null != getCookie("__csid") && "" != getCookie("__csid") ? getCookie("__csid") : "NA", !newSessionStartOver && clickedStartOver && (clickedStartOver = !1) }), $(document).on("click", "#btnSubmitTranscriptRequest", function () { var o = getCookie("__ctromni"); newSessionChatTranscript = "971-0-0" == o, chatId = null != getCookie("__csid") && null != getCookie("__csid") && "" != getCookie("__csid") ? getCookie("__csid") : "NA", newSessionChatTranscript || (setCookie("__ctromni", "971-0-0"), s_oTrackPage({ s_oChat: chatId + "~" + engagementId + "~" + e + "~" + chatButtonType + "~" + position + "~Agent~" + entryPointID + "~" + t + "~NA~CT", s_oAPT: "971-0-0", s_oAJC: !0 }), newSessionChatTranscript = !0) }), o || (newSessionAgent = !1, newSessionMsg = !1, newSessionMinimize = !1, newSessionStartOver = !1, newSessionChatTranscript = !1, newSessionClose = !1, newSessionsocketConnected = !1) } function setCookie(e, t) { var o = "https:" == window.location.protocol; document.cookie = o ? e + "=" + t + ";domain=.luckymobile.ca;path=/;secure=true;samesite=Strict" : e + "=" + t + ";domain=.luckymobile.ca;path=/" } function deleteCookies() { for (var e = 0; e < omnitureCookieNames.length; e++)document.cookie = omnitureCookieNames[e] + "=;expires=" + (new Date).toUTCString() + ";domain=.luckymobile.ca;path=/" } $(document).on("DOMSubtreeModified", "#messages", function () { $("#messages").find("a").each(function () { var e = $(this).attr("href"), t = $(this).text(); t = t.replace(/\s/g, ""), "" !== e && "#" !== e && (e.indexOf("?") > -1 ? -1 == e.indexOf("?INT=") && -1 == e.indexOf("&INT=") && $(this).attr("href", e + "&INT=MOB_mobsuppg_TXT_Echat_Mass_060621_aj_" + t) : -1 == e.indexOf("?INT=") && $(this).attr("href", e + "?INT=MOB_mobsuppg_TXT_Echat_Mass_060621_aj_" + t)) }) });